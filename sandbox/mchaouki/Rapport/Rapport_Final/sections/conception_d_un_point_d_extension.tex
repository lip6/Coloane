\section{Concéption de points d'extensions}
Nous allons, vous présenter, comment créer un point d'extension, pour permttre à Coloane, d'intégrer via des contributions de nouveaux services d'exportations. Pour cela, nous allons utiliser le PDE (Plug--ins Developement Environment) présent dans Eclipse.
 
\subsection{Déclaration du point d'extension}
L'onglet 'Extension points' de l'éditeur de fichiers manifestes aide à la création 
de nouveaux points d'extension. Ouvrir cet onglet pour le plugin 'fr.lip6.move.coloane.core'. 
Le bouton 'Add...' ouvre un assistant permettant d'indiquer l'ID du nouveau point d'extension (l'ID réel sera 
la concaténation de l'ID du plugin et de la valeur de ce champ), son nom et le nom du fichier qui contiendra la grammaire :
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe1.jpg}
%%%%%%%%%%%

\subsection{Définition de la grammaire}
Notre point d'extension doit permettre à des plugins de contribuer de nouveaux types de formats d'exportations. Nous proposons donc que la grammaire soit composée d'un élément XML nommé 'Exports' comprenant trois attributs 'id', 'nom' et 'classe'.

Cette grammaire doit être définie dans un fichier XMLSchema avec une extension .exsd. Le fichier a été créé automatiquement lors de l'étape précédente et l'éditeur de fichiers .exsd a été ouvert sur notre fichier. L'éditeur dispose de plusieurs onglets, se placer dans l'onglet 'Definition' et utiliser le bouton 'Add Element' pour créer un élément XML que nous nommerons 'Exports' :
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe2.jpg}
%%%%%%%%%%%
\\
\\
\\

Utiliser le bouton 'New Attribute' pour créer les attributs 'id' et 'nom'. Indiquer que ces attributs sont 'required' et de type 'string' :
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe3.jpg}
%%%%%%%%%%%
\\
\\
\\

Créer ensuite l'attribut 'classe'. Spécifier qu'il est 'required' et de type 'java'. Cet attribut sera utilisé par les plugins contributeurs pour indiquer le nom de la classe qui gère l'exportation d'un format. Pour que notre plugin (celui définissant le point d'extension) puisse manipuler les classes fournies par les plugins contributeurs, nous allons leur imposer une interface commune. Le nom de cette interface est à indiquer dans le champ 'Implements' :
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe4.jpg}
%%%%%%%%%%%
\\
\\
\\

Ajouter l'interface dans le plugin 'fr.lip6.move.coloane.core.interfaces', son code est le suivant


%\begin{verbatim}
\begin{lstlisting}[language=java]
package fr.lip6.move.coloane.core.interfaces;

import fr.lip6.move.coloane.core.exceptions.ColoaneException;
import fr.lip6.move.coloane.core.ui.model.IModelImpl;

public interface IExportTo {
	public void export(IModelImpl modeleCourant,String filePath) 
		throws ColoaneException;
}
\end{lstlisting}
%\end{verbatim}




Cette interface devra être utilisable par les plugins dépendants : dans l'éditeur de fichier manifestes, sélectionner l'onglet 'Runtime' et ajouter 
le package \\ 'fr.lip6.move.coloane.core.interfaces' dans la section 'Exported Packages'.



La grammaire d'un point d'extension se compose systématiquement d'un élément parent nommé 'extension'. Il nous faut indiquer la relation entre l'élément 'extension' et notre élément 'Export'. Dans notre cas l'élément 'extension' peut contenir plusieurs sous-éléments 'Export' (un plugin peut fournir plusieurs types de formats d'exportations), pour définir ce lien il faut utiliser le menu contextuel sur l'élément extension et sélectionner 'New - Compositor - Sequence' :
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe5.jpg}
%%%%%%%%%%%
\\
\\
\\

Ouvrir ensuite le menu contextuel sur la séquence et sélectionner 'New - Reference - Export' :
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe6.jpg}
%%%%%%%%%%%
\\
\\
\\

Sélectionner la référence vers l'élement 'Export' et cocher la case 'Unbounded' dans la partie de gauche:
\\
%%%%%%%%%%%
\includegraphics[width=1.00\textwidth]{images/pe7.jpg}
%%%%%%%%%%%
\\
\\
\\




















